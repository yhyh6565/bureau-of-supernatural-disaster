# 🗄️ 데이터 요구사항 명세서 v4.0

현재 시스템의 테스트를 위해 필요한 핵심 데이터 카테고리와 각 항목별 필요 필드를 정리했습니다.

**v5.0 변경사항** (2026-01-01):
- **데이터 저장 형식 변경**: TypeScript(`.ts`) -> JSON(`.json`) 파일로 전면 교체
- **JSON 데이터 관리**: 모든 데이터는 `src/data` 내부의 JSON 파일에서 로드되며, 날짜 문자열은 자동으로 변환됩니다.

**v4.0 변경사항** (2026-01-01):
- **데이터 이원화 구조 확립**: `src/data/common/` (공통 데이터) -> `src/data/global/`로 변경됨
- **code vs codename 구분**: `code` = 부서-숫자 (HMU-001), `codename` = 별명 (청동, 포도)
- **장비/방문장소**: `imageEmoji` 필드 완전 제거 ✓
- **재난 등급**: 멸형/파형/뇌형/고형으로 통일 ✓
- **7명 페르소나 구현**: 박홍림, 최요원, 류재관, 김솔음, 해금, 고영은, 장허운

**데이터 소스 경로**:
**데이터 소스 경로**:
- 공통 데이터: `src/data/global/` (incidents.json, notifications.json, equipment.json, locations.json)
- 평범한 데이터: `src/data/ordinary/` (messages.json, approvals.json, schedules.json, incidents.json)
- 페르소나 데이터: `src/data/personas/{캐릭터명}/` (incidents.json, messages.json, notifications.json, approvals.json, schedules.json)
- 병합 로직: `src/data/dataManager.ts`

---

## 1. 👤 요원 데이터 (`Agent`)
**용도**: 로그인 및 업무 권한 관리, 부서별 기능 테스트, 마이페이지

| 필드 (Field) | 타입 | 필수 | 설명 및 값(Value) 예시 |
|:---:|:---:|:---:|---|
| **`id`** | string | ✅ | `agent-001`, `agent-002` 등 고유값 |
| **`name`** | string | ✅ | **로그인 ID로 사용됨** (예: `박홍림`, `최요원`, `류재관`) |
| **`code`** | string | ✅ | **부서-숫자 코드** (예: `HMU-001`, `BKH-201`, `JJK-201`)<br>백호=BKH, 현무=HMU, 주작=JJK |
| **`codename`** | string | ✅ | **작전 코드명(별명)** (예: `청동`, `포도`, `해금`, `박하`, `화각`) |
| **`department`** | string | ✅ | 소속 부서명 (`신규조사반`, `출동구조반`, `현장정리반`) |
| **`team`** | string | ✅ | 소속 팀 (예: `현무1팀`, `현무2팀`, `백호1팀`, `주작1팀`) |
| **`rank`** | string | ✅ | 직급 (주무관, 실무관, 팀장 등) - *아래 직급 체계 참고* |
| **`grade`** | number | ✅ | **급수** (9~1급) - 장비/열람 권한의 기준 (예: `6`, `7`, `8`, `9`) |
| **`extension`** | string | ✅ | 내선번호 (예: `3401`, `3402`) |
| **`status`** | enum | ✅ | 현재 상태 (`정상`, `부상`, `오염`, `실종`, `사망`) |
| **`contamination`** | number | ✅ | 오염도 (0~100) - 시간 경과시 증가 |
| **`totalIncidents`** | number | ✅ | 총 처리 재난 수 (예: `45`) |
| **`specialCases`** | number | ✅ | 특수 케이스 수 (예: `8`) |
| **`equipmentInUse`** | array | ✅ | 현재 대여 중인 장비 ID 배열 (예: `["eq-002"]`) |
| **`purificationHistory`** | array | ✅ | 용천 선녀탕 방문 날짜 배열 (최근 5회) |
| `funeralPreference` | string | ❌ | 희망 장례법 (`화장`, `매장`, `수목장`, `데이터 소각`, `기억 소거 후 방생`) |

**직급 및 권한 체계 (Grade System)**:
| 급수 | 호칭 (Title) | 권한 및 역할 |
|:---:|:---|:---|
| **9급** | 실무관 (서기보) | 수습 요원. 단독 현장 진입 불가. 기본 장비만 사용. |
| **8급** | 실무관 (서기) | 정식 요원. **일반등급 장비 사용 가능**. |
| **7급** | 주무관 (주사보) | 현장 조장. 특수 장비 제한적 사용. |
| **6급** | 팀장/주무관 (주사)| **고위급 장비 결재/사용 권한**. 대외비(II급) 열람 가능. |
| **5급** | 과장/사무관 | 지휘관. 멸형급 작전 통제. 1급 기밀 열람 가능. |

**예시 데이터** (페르소나 7명):
```
agent-001, 박홍림, HMU-001, 홍화, 출동구조반, 현무1팀, 팀장, 6, 3400, 정상, 15, 89, 25, [eq-008], [2025-11-20;2025-10-15], 화장
agent-002, 최요원, HMU-002, 미상, 출동구조반, 현무1팀, 주무관, 7, 3401, 정상, 28, 52, 15, [eq-005;eq-008], [2025-12-28;2025-12-21], 화장
agent-003, 류재관, HMU-003, 청동, 출동구조반, 현무1팀, 실무관, 8, 3402, 정상, 12, 38, 7, [], [2025-11-28;2025-10-30], 수목장
agent-004, 김솔음, HMU-004, 포도, 출동구조반, 현무1팀, 주무관, 7, 3403, 정상, 18, 32, 11, [eq-013], [2025-12-15;2025-11-20], 데이터 소각
agent-005, 해금, HMU-301, 해금, 출동구조반, 현무3팀, 팀장, 6, 3410, 정상, 8, 67, 18, [eq-007], [2025-12-10;2025-11-18], 화장
agent-006, 고영은, BKH-201, 박하, 신규조사반, 백호2팀, 주무관, 7, 3301, 정상, 10, 28, 6, [], [2025-12-20;2025-11-15], 매장
agent-007, 장허운, JJK-201, 화각, 현장정리반, 주작2팀, 주무관, 7, 3501, 정상, 22, 35, 8, [eq-010], [2025-12-18;2025-11-10], 수목장
```

---

## 2. ⚠️ 재난 및 사건 데이터 (`Incident`)
**용도**: 대시보드 리스트, 상세 페이지, 결재 연동 등 **가장 핵심적인 데이터**

| 필드 | 타입 | 필수 | 설명 |
|:---:|:---:|:---:|---|
| **`id`** | string | ✅ | `inc-001` 등 고유값 |
| **`caseNumber`** | string | ✅ | 내부 사건 번호 (예: `20251231-001`) |
| **`registrationNumber`** | string | ✅ | **공식 등록번호** (예: `0001PSYA.2025.가01`) |
| **`location`** | string | ✅ | 발생 위치 (예: `서울특별시 종로구 청운동 폐가`) |
| **`dangerLevel`** | enum | ✅ | **위험 등급 (형刑 시스템)** (`멸형`, `파형`, `뇌형`, `고형`) |
| **`status`** | enum | ✅ | 진행 상태 (`접수`, `조사중`, `구조대기`, `구조중`, `정리대기`, `정리중`, `종결`) |
| **`reportContent`** | string | ✅ | 최초 제보/신고 내용 (상세할수록 좋음) |
| **`requiresPatrol`** | boolean | ✅ | 정기 순찰 필요 여부 |
| `gpsCoordinates` | object | ❌ | GPS 좌표 `{ lat: 37.5665, lng: 126.9780 }` |
| `countermeasure` | string | ❌ | 파훼법/대응전략 (예: `해태상 배치 필요`, `소금 결계 설치`) |
| `entryRestrictions` | string | ❌ | 진입 금지 조건 (예: `단독 진입 금지, 해태상 미보유자 진입 금지`) |
| **`createdAt`** | date | ✅ | 접수 일시 (ISO 형식) |
| **`updatedAt`** | date | ✅ | 최종 수정 일시 |

**등급별 정의**:
- **멸형** (滅刑): 사망처리자 오십만 명 이상, 최고 위험
- **파형** (破刑): 수십 년간 수백 명 실종, 종결 불가능
- **뇌형** (瀨刑): 수십 년간 수십 명 피해, 봉인 가능
- **고형** (苦刑): 인명피해 없음, 낮은 위험도

**예시 데이터**:
```
inc-001, 20251231-001, 0001PSYA.2025.가01, 서울특별시 종로구 청운동 폐가, 뇌형, 접수, 야간 산책 중 폐가에서 인간이 아닌 것으로 추정되는 그림자 목격, false, , , , 2025-12-31T02:30:00, 2025-12-31T02:30:00
inc-002, 20251230-003, 0002PSYA.2025.가02, 경기도 파주시 접경지역 A구역, 멸형, 조사중, 시간 왜곡 현상 발생. 해당 구역 진입자 실종, false, , 해태상 배치 필요, 단독 진입 금지, 2025-12-30T18:00:00, 2025-12-31T09:00:00
```

---

## 3. 📝 결재 문서 (`ApprovalDocument`)
**용도**: 업무 처리 승인, 장비 대여/방문 신청 연동 테스트

| 필드 | 타입 | 필수 | 설명 |
|:---:|:---:|:---:|---|
| **`id`** | string | ✅ | `appr-001` 등 |
| **`type`** | enum | ✅ | 문서 유형 (`조사보고서`, `출동일지`, `순찰일지`, `현장정리보고서`, `시말서`, `장비품의서`, `방문품의서`) |
| **`title`** | string | ✅ | 제목 |
| **`content`** | string | ✅ | 본문 내용 |
| **`status`** | enum | ✅ | `작성중`, `결재대기`, `승인`, `반려` |
| **`createdBy`** | string | ✅ | 기안자 ID (Agent ID와 매칭) |
| **`approver`** | string | ✅ | 결재자 ID (일반적으로 팀장급) |
| **`createdAt`** | date | ✅ | 작성 일시 |
| `relatedIncidentId` | string | ❌ | 관련 재난 ID (보고서의 경우 필수) |
| `rejectReason` | string | ❌ | 반려 시 반려 사유 |

**시말서 템플릿 유형**:
1. 도깨비 시련 발동 사고
2. 장비 분실
3. 민간인 목격 사고
4. 실명 노출 (코드명 미사용)

**예시 데이터**:
```
appr-001, 조사보고서, 청운동 폐가 조사 보고, 조사 결과 뇌형급 재난으로 판정합니다..., 결재대기, agent-001, agent-002, 2025-12-31T10:00:00, inc-001,
```

---

## 4. 💌 쪽지 (`Message`)
**용도**: 사내 커뮤니케이션 및 시스템 알림 테스트

| 필드 | 타입 | 필수 | 설명 |
|:---:|:---:|:---:|---|
| **`id`** | string | ✅ | `msg-001` 등 |
| **`senderId`** | string | ✅ | 보낸 사람 ID (`system`이면 시스템 알림) |
| **`receiverId`** | string | ✅ | 받는 사람 ID |
| **`title`** | string | ✅ | 제목 |
| **`content`** | string | ✅ | 내용 |
| **`createdAt`** | date | ✅ | 발송 시간 |
| **`isRead`** | boolean | ✅ | 읽음 여부 |

**예시 데이터**:
```
msg-001, system, agent-001, 오염도 주의 안내, 귀하의 현재 오염도가 35%입니다. 용천 선녀탕 방문을 권장합니다., 2025-12-31T09:00:00, false
msg-002, agent-002, agent-001, 청운동 사건 협조 요청, 해당 건 조사 시 현무팀 지원이 필요할 것 같습니다., 2025-12-31T11:30:00, true
```

---

## 5. 🧰 장비 및 자산 (`Equipment`)
**용도**: 장비 대여/지급 페이지 리스트업

| 필드 | 타입 | 필수 | 설명 |
|:---:|:---:|:---:|---|
| **`id`** | string | ✅ | `eq-001` 등 |
| **`name`** | string | ✅ | 장비명 (예: `도깨비불`, `은심장`) |
| **`category`** | enum | ✅ | `일반대여`, `고위급대여`, `지급` |
| **`description`** | string | ✅ | 설명 |
| **`totalStock`** | number | ✅ | 전체 재고 |
| **`availableStock`** | number | ✅ | 현재 대여/지급 가능 재고 |
| **`requiresApproval`** | boolean | ✅ | 대여 시 결재 필요 여부 |
| `specialNote` | string | ❌ | 특이사항 (예: `탐라행 급행열차 사건 참고`, `3일 후 재충전 필요`) |

**일반 장비 (승인 필요)**:
```
eq-001, 도깨비불, 일반대여, 어둠 속 길 안내용, 10, 8, true,
eq-002, 악의 저울, 일반대여, 오염도 측정 장비, 5, 3, true,
eq-003, 간이 유리감옥, 일반대여, 소형 개체 봉인용, 8, 6, true,
eq-004, 해태상(소형), 일반대여, 결계 설치용, 12, 10, true,
eq-005, 줄잡이, 일반대여, 괴담 존재 포획/제어, 15, 12, true,
eq-006, 신발끈, 일반대여, 이동 및 탈출용, 20, 18, true,
```

**고위급 장비 (팀장 이상 결재)**:
```
eq-007, 은심장, 고위급대여, 집단 영향력 행사, 3, 2, true, 탐라행 급행열차 사건 참고
eq-008, 도깨비 초롱, 고위급대여, 특수 조명 및 탐사, 5, 4, true, 3일 후 재충전 필요
eq-009, 도깨비 감투, 고위급대여, 투명화 능력, 2, 1, true, 특별 승인 필요
```

**지급 물품 (소모품)**:
```
eq-010, 유리 손포, 지급, 오염 물질 취급용 장갑, 500, 450, false,
eq-011, 포승줄, 지급, 봉인 문양 특수 포승줄, 200, 180, false,
eq-012, 시큼달큼, 지급, 정신 오염 해독용 사탕, 1000, 950, false,
eq-013, 메모리얼 그립톡, 지급, 기억 고정용 액세서리, 150, 120, false,
```

---

## 6. 📍 방문 장소 (`VisitLocation`)
**용도**: 시설 예약 페이지 테스트

| 필드 | 타입 | 필수 | 설명 |
|:---:|:---:|:---:|---|
| **`id`** | string | ✅ | `loc-001` 등 |
| **`name`** | string | ✅ | 장소 이름 (예: `도깨비 공방`) |
| **`description`** | string | ✅ | 상세 설명 |
| **`operatingHours`** | string | ✅ | 운영 시간 (예: `09:00-18:00`) |
| **`requiresApproval`** | boolean | ✅ | 예약 시 승인 필요 여부 |
| `specialNote` | string | ❌ | 특이사항 |

**예시 데이터**:
```
loc-001, 도깨비 공방, 특수 장비 제작/수리, 09:00-18:00, false, 초재관 주요 장비 제작처, 비밀 협력 관계
loc-002, 바리데기 세공소, 봉인 장치/부적 제작, 10:00-17:00, false,
loc-003, 이정 책방, 고문서 열람/연구, 08:00-20:00, false,
loc-004, 용천 선녀탕, 정신 오염 정화 시설, 06:00-22:00, true, 오염도 -30% 효과
```

---

## 7. 🗓️ 일정 (`Schedule`)
**용도**: 대시보드 주간 일정 위젯 표시

| 필드 | 타입 | 필수 | 설명 |
|:---:|:---:|:---:|---|
| **`id`** | string | ✅ | `sch-001` 등 |
| **`title`** | string | ✅ | 일정명 |
| **`type`** | enum | ✅ | `작전`, `방문예약`, `결재마감`, `당직`, `훈련` |
| **`date`** | date | ✅ | 일정 일시 (ISO 형식) |
| `relatedId` | string | ❌ | 관련 ID (재난, 결재, 방문 등) |

**예시 데이터**:
```
sch-001, 정기 안전 교육, 훈련, 2026-01-02T10:00:00,
sch-002, 도깨비 공방 방문, 방문예약, 2026-01-02T14:00:00, loc-001
sch-003, 청운동 재난 조사, 작전, 2026-01-03T09:00:00, inc-001
sch-004, 야간 당직, 당직, 2026-01-02T22:00:00,
sch-005, 월간 보고서 제출, 결재마감, 2026-01-05T18:00:00,
```

---

## 8. 📢 공지사항 (`Notification`)
**용도**: 공지사항 페이지 및 알림 시스템

| 필드 | 타입 | 필수 | 설명 |
|:---:|:---:|:---:|---|
| **`id`** | string | ✅ | `noti-001` 등 |
| **`title`** | string | ✅ | 제목 |
| **`content`** | string | ✅ | 내용 |
| **`isUrgent`** | boolean | ✅ | 긴급 여부 |
| **`createdAt`** | date | ✅ | 작성 일시 |
| **`isRead`** | boolean | ✅ | 읽음 여부 |
| `department` | enum | ❌ | 대상 부서 (전체공지면 비워둠) |

**예시 데이터**:
```
noti-001, [긴급] 파주 A구역 접근 금지 안내, 파주시 접경지역 A구역에서 멸형급 재난이 발생했습니다..., true, 2025-12-30T19:00:00, false,
noti-002, 12월 식단표 안내, 12월 구내식당 식단표입니다. 금일 점심: 김치찌개, 동치미, 계란말이, false, 2025-12-01T09:00:00, true,
noti-003, [보안] 페르소나 키 관리 수칙, 페르소나 키는 외부 노출 금지입니다..., false, 2025-12-15T14:00:00, true,
noti-004, [현무팀] 도깨비 시련 발동 사고 재발 방지 안내, 최근 도깨비 초롱 사용 중 시련이 발동되는 사고가 발생했습니다..., false, 2025-12-20T10:00:00, false, hyunmu
```

---

## 📋 JSON 파일 형식 가이드 (변경됨)

각 데이터는 `src/data` 내부의 적절한 위치에 JSON 파일로 작성되어야 합니다.

**파일 구조**:
1. `src/data/global/`: incidents.json, notifications.json, equipment.json, locations.json
2. `src/data/ordinary/`: messages.json, approvals.json, schedules.json, incidents.json
3. `src/data/personas/{name}/`: incidents.json, messages.json, notifications.json, approvals.json, schedules.json

**작성 예시 (incidents.json)**:
```json
[
  {
    "id": "inc-001",
    "caseNumber": "20251231-001",
    "registrationNumber": "0001PSYA.2025.가01",
    "location": "서울특별시 종로구 청운동 폐가",
    "dangerLevel": "뇌형",
    "status": "접수",
    "reportContent": "야간 산책 중 폐가에서 인간이 아닌 것으로 추정되는 그림자 목격",
    "requiresPatrol": false,
    "createdAt": "2025-12-31T02:30:00",
    "updatedAt": "2025-12-31T02:30:00"
  }
]
```

---

## v5.0 변경 로그

**데이터 작성 시 주의사항**:
- 날짜는 ISO 형식 문자열 사용 (`"2025-12-31T10:00:00"`)
- JSON 형식이므로 모든 키와 문자열 값은 큰따옴표(`"`)로 감싸야 합니다.
- 마지막 항목 뒤에는 쉼표(`,`)를 붙이지 않습니다.
- 한글 인코딩은 UTF-8 사용
