import XLSX from 'xlsx';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';
import { mkdirSync } from 'fs';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

// Create workbook
const wb = XLSX.utils.book_new();

// ===== 1. AGENTS SHEET (6명 맞춤형 캐릭터) =====
const agentsData = [
  ['id', 'name', 'code', 'codename', 'department', 'team', 'rank', 'grade', 'extension', 'status', 'contamination', 'totalIncidents', 'specialCases', 'equipmentInUse', 'purificationHistory', 'funeralPreference'],

  // 현무1팀
  ['agent-001', '박홍림', 'HMU-001', '홍화', '출동구조반', '현무1팀', '팀장', 6, '3400', '부상', 15, 89, 25, '[eq-008]', '[2025-11-20;2025-10-15;2025-09-10]', '화장'],
  ['agent-002', '최요원', 'HMU-002', '미상', '출동구조반', '현무1팀', '주무관', 7, '3401', '정상', 28, 52, 15, '[eq-005;eq-008]', '[2025-12-28;2025-12-21;2025-12-14;2025-12-07;2025-11-30]', '화장'],
  ['agent-003', '류재관', 'HMU-003', '청동', '출동구조반', '현무1팀', '실무관', 8, '3402', '정상', 12, 38, 7, '[]', '[2025-11-28;2025-10-30]', '수목장'],
  ['agent-004', '김솔음', 'HMU-004', '포도', '출동구조반', '현무1팀', '주무관', 7, '3403', '정상', 18, 32, 11, '[eq-013]', '[2025-12-15;2025-11-20]', '데이터 소각'],

  // 현무3팀
  ['agent-005', '해금', 'HMU-301', '해금', '출동구조반', '현무3팀', '팀장', 6, '3410', '정상', 8, 67, 18, '[eq-007]', '[2025-12-10;2025-11-18;2025-10-25]', '화장'],

  // 백호2팀 (신규조사반)
  ['agent-006', '고영은', 'BKH-201', '박하', '신규조사반', '백호2팀', '주무관', 7, '3301', '정상', 10, 28, 6, '[]', '[2025-12-20;2025-11-15]', '매장'],

  // 주작2팀 (현장정리반)
  ['agent-007', '장허운', 'JJK-201', '화각', '현장정리반', '주작2팀', '주무관', 7, '3501', '정상', 22, 35, 8, '[eq-010]', '[2025-12-18;2025-11-10]', '수목장'],

  // 일반 요원 (템플릿)
  ['agent-008', '', 'BKH-001', '', '신규조사반', '백호1팀', '주무관', 7, '3302', '정상', 0, 0, 0, '[]', '[]', ''],
  ['agent-009', '', 'JJK-001', '', '현장정리반', '주작1팀', '주무관', 7, '3502', '정상', 0, 0, 0, '[]', '[]', ''],
];
const wsAgents = XLSX.utils.aoa_to_sheet(agentsData);
XLSX.utils.book_append_sheet(wb, wsAgents, 'agents');

// ===== 2. INCIDENTS SHEET =====
const incidentsData = [
  ['id', 'caseNumber', 'registrationNumber', 'location', 'dangerLevel', 'status', 'reportContent', 'requiresPatrol', 'assignedAgent', 'countermeasure', 'entryRestrictions', 'createdAt', 'updatedAt'],

  // 최요원 (agent-002) - 개인 출동, 사고
  ['inc-001', '20251228-003', '0001PSYA.2025.가01', '서울특별시 강남구 폐건물', '뇌형', '구조중', '건물 지하에서 원인 불명의 소음 및 실종자 발생. 최요원 단독 출동.', 'false', 'agent-002', '줄잡이 사용', '단독 진입 금지', '2025-12-28T14:30:00', '2025-12-28T18:00:00'],
  ['inc-002', '20251220-001', '0002PSYA.2025.가02', '인천광역시 중구 항구', '고형', '종결', '안개 속에서 방향 감각 상실 신고. 최요원 신속 대응으로 조기 종결.', 'true', 'agent-002', '도깨비불 배치', '', '2025-12-20T09:00:00', '2025-12-21T14:00:00'],
  ['inc-003', '20251215-005', '0003PSYA.2025.가03', '경기도 고양시 일산 호수공원', '뇌형', '정리대기', '야간 산책로에서 시간 왜곡 현상. 최요원 부상으로 후송.', 'true', 'agent-002', '해태상 결계', '야간 진입 금지', '2025-12-15T22:00:00', '2025-12-16T03:00:00'],

  // 류재관 (agent-003) - 정규 업무, 체계적
  ['inc-004', '20251225-001', '0004PSYA.2025.가04', '전라북도 전주시 한옥마을', '고형', '종결', '고택에서 부적 손상 발견. 류재관 요원의 부적 재시공으로 안정화.', 'true', 'agent-003', '봉인 부적 재설치', '', '2025-12-25T10:00:00', '2025-12-26T16:00:00'],
  ['inc-005', '20251218-002', '0005PSYA.2025.가05', '충청남도 공주시 고분군', '뇌형', '조사중', '고분 내부 봉인 약화 감지. 류재관 요원 정밀 조사 중.', 'false', 'agent-003', '경문 강화', '전문가 동반 필수', '2025-12-18T08:00:00', '2025-12-30T11:00:00'],

  // 김솔음 (agent-004) - 창의적 해결
  ['inc-006', '20251222-003', '0006PSYA.2025.가06', '서울특별시 종로구 북촌 한옥', '뇌형', '구조중', '한옥 내부 시공간 왜곡. 포도 요원 임기응변으로 2명 구조.', 'false', 'agent-004', '메모리얼 그립톡 활용', '', '2025-12-22T15:00:00', '2025-12-23T09:00:00'],
  ['inc-007', '20251210-001', '0007PSYA.2025.가07', '부산광역시 해운대구 해변', '고형', '종결', '해변 모래성에서 이상 현상. 포도 요원 창의적 대응으로 신속 해결.', 'false', 'agent-004', '소금 결계', '', '2025-12-10T11:00:00', '2025-12-11T14:00:00'],

  // 해금 (agent-005) - 멸형급, 고위급
  ['inc-008', '20251230-001', '0008PSYA.2025.가08', '경기도 파주시 접경지역 A구역', '멸형', '조사중', '시간 왜곡 현상 발생. 군 통제선 설정. 현무3팀 해금 팀장 지휘.', 'false', 'agent-005', '은심장 + 해태상 배치', '6급 이상만 진입 가능', '2025-12-30T18:00:00', '2025-12-31T09:00:00'],
  ['inc-009', '20251201-002', '0009PSYA.2025.가09', '강원도 철원군 폐터널', '파형', '정리대기', '수십 년간 실종자 다수. 해금 팀장 봉인 작업 완료.', 'true', 'agent-005', '특급 봉인', '월 1회 순찰 필수', '2025-12-01T06:00:00', '2025-12-15T18:00:00'],

  // 고영은 (agent-006) - 신규조사, 의료 지식
  ['inc-010', '20251226-001', '0010PSYA.2025.가10', '대전광역시 유성구 폐병원', '뇌형', '조사중', '폐병원에서 환자 목격 신고. 박하 요원 의료 지식 활용 조사 중.', 'false', 'agent-006', '의료 기록 분석', '', '2025-12-26T10:00:00', '2025-12-30T14:00:00'],
  ['inc-011', '20251212-003', '0011PSYA.2025.가11', '광주광역시 동구 약국', '고형', '종결', '약국 내 약품 이상 증식. 박하 요원 약리 분석으로 원인 규명.', 'false', 'agent-006', '약품 폐기', '', '2025-12-12T09:00:00', '2025-12-13T16:00:00'],

  // 장허운 (agent-007) - 현장정리, 고어 약함
  ['inc-012', '20251224-002', '0012PSYA.2025.가12', '서울특별시 성북구 주택가', '고형', '정리중', '종결된 재난 현장 정리. 화각 요원 배정. 시신 처리 작업 진행.', 'false', 'agent-007', '현장 소독 및 복구', '', '2025-12-24T14:00:00', '2025-12-25T18:00:00'],
  ['inc-013', '20251205-001', '0013PSYA.2025.가13', '경기도 성남시 폐공장', '뇌형', '정리대기', '현무팀 종결 후 정리 대기. 화각 요원 출동 예정.', 'true', 'agent-007', '공장 폐쇄 및 봉인', '', '2025-12-05T11:00:00', '2025-12-30T09:00:00'],

  // 일반 재난
  ['inc-014', '20251231-001', '0014PSYA.2025.가14', '서울특별시 청운동 폐가', '뇌형', '접수', '야간 산책 중 그림자 목격. 백호팀 조사 대기.', 'false', '', '', '', '2025-12-31T02:30:00', '2025-12-31T02:30:00'],
];
const wsIncidents = XLSX.utils.aoa_to_sheet(incidentsData);
XLSX.utils.book_append_sheet(wb, wsIncidents, 'incidents');

// ===== 3. MESSAGES SHEET =====
const messagesData = [
  ['id', 'senderId', 'receiverId', 'title', 'content', 'createdAt', 'isRead'],

  // 최요원 (agent-002)
  ['msg-001', 'system', 'agent-002', '오염도 주의 안내', '귀하의 현재 오염도가 28%입니다. 다음 주 정기 검진을 반드시 받으시기 바랍니다.', '2025-12-29T09:00:00', 'false'],
  ['msg-002', 'agent-001', 'agent-002', '단독 출동 금지 경고', '강남구 폐건물 사건 관련하여, 향후 단독 출동은 금지됩니다. 팀 동반 필수.', '2025-12-28T19:00:00', 'true'],
  ['msg-003', 'system', 'agent-002', '장비 반납 안내', '대여 중인 도깨비 초롱(eq-008)의 반납 기한이 내일입니다.', '2025-12-30T10:00:00', 'false'],
  ['msg-004', 'agent-002', 'agent-003', '강남 사건 지원 요청', '재관이, 강남 폐건물 사건 부적 좀 확인해줄 수 있어? 뭔가 봉인이 풀린 것 같은데.', '2025-12-28T15:30:00', 'true'],

  // 류재관 (agent-003)
  ['msg-005', 'agent-003', 'agent-002', 'Re: 강남 사건 지원 요청', '알겠습니다. 내일 오전 현장 방문하겠습니다. 사진 먼저 보내주세요.', '2025-12-28T16:00:00', 'true'],
  ['msg-006', 'system', 'agent-003', '부적 재료 입고 안내', '귀하가 신청한 황지(黃紙) 100매가 장비관리반에 입고되었습니다.', '2025-12-20T14:00:00', 'true'],
  ['msg-007', 'agent-001', 'agent-003', '전주 한옥마을 보고서 승인', '전주 사건 처리 보고서 검토했습니다. 체계적으로 잘 정리되었습니다. 승인합니다.', '2025-12-27T10:00:00', 'true'],

  // 김솔음 (agent-004)
  ['msg-008', 'agent-002', 'agent-004', '현무1팀 회식 안내', '솔음씨, 이번 주 금요일 저녁 7시 팀 회식입니다. 참석 가능하시죠?', '2025-12-30T11:00:00', 'false'],
  ['msg-009', 'agent-003', 'agent-004', '북촌 사건 협조 감사', '어제 북촌 사건에서 신속한 판단 덕분에 민간인 피해를 최소화했습니다. 수고하셨습니다.', '2025-12-23T10:00:00', 'true'],
  ['msg-010', 'system', 'agent-004', '메모리얼 그립톡 업데이트', '귀하의 메모리얼 그립톡에 새로운 펌웨어가 적용되었습니다. 재부팅해주세요.', '2025-12-25T09:00:00', 'true'],
  ['msg-011', 'agent-006', 'agent-004', '점심 같이?', '솔음씨, 오늘 점심 같이 먹을래요? 구내식당 비빔냉면 괜찮다던데.', '2025-12-30T11:30:00', 'false'],

  // 해금 (agent-005)
  ['msg-012', 'system', 'agent-005', '멸형급 재난 발생 긴급 소집', '파주 A구역 멸형급 재난 발생. 현무3팀 긴급 소집. 즉시 출동 준비 바랍니다.', '2025-12-30T18:05:00', 'true'],
  ['msg-013', 'agent-005', 'agent-001', '파주 사건 보고', '홍림 팀장님, 파주 A구역 1차 조사 완료했습니다. 은심장으로 민간인 대피 완료. 상세 보고서는 내일 제출하겠습니다.', '2025-12-30T22:00:00', 'true'],

  // 고영은 (agent-006)
  ['msg-014', 'agent-004', 'agent-006', 'Re: 점심 같이?', '좋아요! 12시 30분에 식당 앞에서 만나요.', '2025-12-30T11:35:00', 'true'],
  ['msg-015', 'system', 'agent-006', '폐병원 조사 자료 전송', '대전 폐병원 사건 관련 과거 의료 기록을 전송합니다. 참고 바랍니다.', '2025-12-27T10:00:00', 'true'],
  ['msg-016', 'agent-006', 'agent-004', '조사 협조 요청', '솔음씨, 폐병원 조사 때 현무팀 지원이 필요할 것 같아요. 가능하신가요?', '2025-12-26T14:00:00', 'true'],

  // 장허운 (agent-007)
  ['msg-017', 'system', 'agent-007', '현장정리 일정 안내', '성북구 주택가 재난 현장 정리 작업이 12월 24일 14시로 배정되었습니다.', '2025-12-23T09:00:00', 'true'],
  ['msg-018', 'agent-007', 'agent-004', '힘들 때 연락해', '솔음씨, 힘든 일 있으면 언제든 연락해요. 제가 도울 수 있는 게 있다면 돕고 싶어요.', '2025-12-22T20:00:00', 'true'],
  ['msg-019', 'agent-004', 'agent-007', 'Re: 힘들 때 연락해', '고마워요, 허운씨. 덕분에 힘이 나네요.', '2025-12-22T21:00:00', 'true'],
];
const wsMessages = XLSX.utils.aoa_to_sheet(messagesData);
XLSX.utils.book_append_sheet(wb, wsMessages, 'messages');

// ===== 4. SCHEDULES SHEET =====
const schedulesData = [
  ['id', 'title', 'type', 'date', 'agentId', 'relatedId'],

  // 최요원 (매주 검진)
  ['sch-001', '정기 오염도 검진', '훈련', '2026-01-02T09:00:00', 'agent-002', ''],
  ['sch-002', '정기 오염도 검진', '훈련', '2026-01-09T09:00:00', 'agent-002', ''],
  ['sch-003', '정기 오염도 검진', '훈련', '2026-01-16T09:00:00', 'agent-002', ''],
  ['sch-004', '강남 폐건물 재조사', '작전', '2026-01-03T14:00:00', 'agent-002', 'inc-001'],
  ['sch-005', '일산 호수공원 순찰', '작전', '2026-01-05T20:00:00', 'agent-002', 'inc-003'],

  // 류재관 (정규 업무)
  ['sch-006', '전주 한옥마을 순찰', '작전', '2026-01-04T10:00:00', 'agent-003', 'inc-004'],
  ['sch-007', '공주 고분군 조사', '작전', '2026-01-06T08:00:00', 'agent-003', 'inc-005'],
  ['sch-008', '바리데기 세공소 방문', '방문예약', '2026-01-07T14:00:00', 'agent-003', 'loc-002'],
  ['sch-009', '월간 보고서 작성', '결재마감', '2026-01-05T18:00:00', 'agent-003', ''],

  // 김솔음
  ['sch-010', '북촌 한옥 재조사', '작전', '2026-01-03T15:00:00', 'agent-004', 'inc-006'],
  ['sch-011', '신입 요원 교육 참석', '훈련', '2026-01-08T10:00:00', 'agent-004', ''],
  ['sch-012', '용천 선녀탕 방문', '방문예약', '2026-01-10T15:00:00', 'agent-004', 'loc-004'],
  ['sch-013', '영은이랑 점심', '기타', '2026-01-02T12:30:00', 'agent-004', ''],

  // 해금 (팀장)
  ['sch-014', '파주 A구역 2차 조사', '작전', '2026-01-02T09:00:00', 'agent-005', 'inc-008'],
  ['sch-015', '철원 폐터널 월간 순찰', '작전', '2026-01-15T11:00:00', 'agent-005', 'inc-009'],
  ['sch-016', '현무3팀 월례 회의', '훈련', '2026-01-05T14:00:00', 'agent-005', ''],

  // 고영은 (조사 업무)
  ['sch-017', '폐병원 조사', '작전', '2026-01-03T10:00:00', 'agent-006', 'inc-010'],
  ['sch-018', '백호2팀 주간 회의', '훈련', '2026-01-06T09:00:00', 'agent-006', ''],
  ['sch-019', '용천 선녀탕 방문', '방문예약', '2026-01-08T16:00:00', 'agent-006', 'loc-004'],

  // 장허운 (현장정리)
  ['sch-020', '성북구 현장정리', '작전', '2025-12-24T14:00:00', 'agent-007', 'inc-012'],
  ['sch-021', '성남 폐공장 정리', '작전', '2026-01-02T10:00:00', 'agent-007', 'inc-013'],
  ['sch-022', '주작2팀 정기 미팅', '훈련', '2026-01-07T15:00:00', 'agent-007', ''],

  // 전체 일정
  ['sch-023', '정기 안전 교육', '훈련', '2026-01-02T10:00:00', '', ''],
  ['sch-024', '야간 당직', '당직', '2026-01-02T22:00:00', '', ''],
];
const wsSchedules = XLSX.utils.aoa_to_sheet(schedulesData);
XLSX.utils.book_append_sheet(wb, wsSchedules, 'schedules');

// ===== 5. APPROVALS SHEET =====
const approvalsData = [
  ['id', 'type', 'title', 'content', 'status', 'createdBy', 'approver', 'createdAt', 'relatedIncidentId', 'rejectReason'],

  // 최요원 (시말서 많음)
  ['appr-001', '시말서', '단독 출동 건 관련 사과문', '2025년 12월 28일 강남구 폐건물 재난 건에 대하여, 팀 동반 없이 단독으로 출동하여 규정을 위반한 점 깊이 반성합니다. 향후 이러한 일이 재발하지 않도록 주의하겠습니다.', '승인', 'agent-002', 'agent-001', '2025-12-29T10:00:00', 'inc-001', ''],
  ['appr-002', '시말서', '장비 손상 경위서', '일산 호수공원 재난 처리 중 줄잡이가 손상되었습니다. 긴급 상황에서 과도한 힘을 사용한 것이 원인입니다. 수리 비용은 개인 부담하겠습니다.', '결재대기', 'agent-002', 'agent-001', '2025-12-16T14:00:00', 'inc-003', ''],
  ['appr-003', '출동일지', '인천 항구 안개 사건 보고', '인천 중구 항구 안개 사건 출동 결과 보고입니다. 도깨비불 배치로 안개 소멸 확인. 민간인 피해 없음. 현장 정리 완료.', '승인', 'agent-002', 'agent-001', '2025-12-21T16:00:00', 'inc-002', ''],

  // 류재관 (체계적 보고서)
  ['appr-004', '조사보고서', '전주 한옥마을 부적 재시공 보고', '전주시 한옥마을 고택의 봉인 부적 손상을 확인하고 재시공을 완료했습니다. 기존 부적은 약 15년 경과로 효력이 약화되었으며, 신규 부적은 황지에 주사로 제작하여 설치했습니다. 향후 10년간 유효할 것으로 판단됩니다.', '승인', 'agent-003', 'agent-001', '2025-12-27T09:00:00', 'inc-004', ''],
  ['appr-005', '장비품의서', '황지 추가 신청', '부적 제작용 황지 100매 추가 신청합니다. 현재 재고 부족으로 긴급 작업 시 차질이 예상됩니다.', '승인', 'agent-003', 'agent-001', '2025-12-18T10:00:00', '', ''],
  ['appr-006', '순찰일지', '공주 고분군 정밀 조사 일지', '공주 고분군 내부 봉인 상태를 정밀 조사했습니다. 일부 경문의 기력이 약화되어 보강 작업이 필요합니다. 다음 주 재방문 예정입니다.', '작성중', 'agent-003', 'agent-001', '2025-12-30T15:00:00', 'inc-005', ''],

  // 김솔음 (창의적)
  ['appr-007', '출동일지', '북촌 한옥 시공간 왜곡 구조 보고', '북촌 한옥 재난 현장에서 메모리얼 그립톡을 활용한 시공간 좌표 고정으로 실종자 2명을 구조했습니다. 기존 매뉴얼에 없는 방식이지만 효과적이었습니다.', '승인', 'agent-004', 'agent-001', '2025-12-23T14:00:00', 'inc-006', ''],
  ['appr-008', '방문품의서', '용천 선녀탕 방문 신청', '현재 오염도 18%로 주의 단계입니다. 정화를 위해 용천 선녀탕 방문을 신청합니다.', '승인', 'agent-004', 'agent-001', '2025-12-28T10:00:00', '', ''],

  // 해금 (고위급)
  ['appr-009', '조사보고서', '파주 A구역 멸형급 재난 1차 조사 보고', '파주시 접경지역 A구역 시간 왜곡 현상에 대한 1차 조사를 완료했습니다. 은심장을 활용해 민간인 대피를 완료했으며, 군 통제선 설정을 요청했습니다. 6급 이상 요원만 진입 가능하도록 제한합니다.', '승인', 'agent-005', 'system', '2025-12-31T10:00:00', 'inc-008', ''],
  ['appr-010', '장비품의서', '은심장 대여 신청', '파주 A구역 멸형급 재난 대응을 위해 은심장 대여를 신청합니다. 집단 대피 유도에 필수적입니다.', '승인', 'agent-005', 'system', '2025-12-30T17:00:00', '', ''],

  // 고영은 (의료 지식 활용)
  ['appr-011', '조사보고서', '대전 폐병원 조사 중간 보고', '대전 폐병원 재난 조사 중입니다. 과거 의료 기록을 분석한 결과, 환자 목격 현상은 1980년대 의료 사고와 연관된 것으로 추정됩니다. 추가 조사 필요.', '작성중', 'agent-006', 'system', '2025-12-30T16:00:00', 'inc-010', ''],
  ['appr-012', '방문품의서', '용천 선녀탕 방문 신청', '오염도 10%이나 예방 차원에서 정화 방문을 신청합니다.', '승인', 'agent-006', 'system', '2025-12-27T10:00:00', '', ''],

  // 장허운 (현장정리)
  ['appr-013', '현장정리보고서', '성북구 주택가 현장정리 보고', '성북구 주택가 재난 현장 정리를 완료했습니다. 시신 처리 및 현장 소독 완료. 민간인 목격 가능성 제거를 위해 기억 소거 작업도 병행했습니다.', '승인', 'agent-007', 'system', '2025-12-25T20:00:00', 'inc-012', ''],
  ['appr-014', '시말서', '현장정리 중 컨디션 난조 사과', '성북구 현장정리 중 시신 처리 과정에서 일시적으로 컨디션 난조를 겪어 작업이 지연되었습니다. 죄송합니다. 향후 심리적 준비를 철저히 하겠습니다.', '승인', 'agent-007', 'system', '2025-12-25T21:00:00', 'inc-012', ''],
];
const wsApprovals = XLSX.utils.aoa_to_sheet(approvalsData);
XLSX.utils.book_append_sheet(wb, wsApprovals, 'approvals');

// ===== 6. NOTIFICATIONS SHEET =====
const notificationsData = [
  ['id', 'title', 'content', 'isUrgent', 'createdAt', 'isRead', 'department', 'targetAgent'],

  // 전체 공지
  ['noti-001', '[긴급] 파주 A구역 접근 금지 안내', '파주시 접경지역 A구역에서 멸형급 재난이 발생했습니다. 시간 왜곡 현상으로 인해 진입자 실종 사고가 발생하고 있습니다. 6급 이상 요원 외 접근을 금지합니다.', 'true', '2025-12-30T19:00:00', 'false', '', ''],
  ['noti-002', '12월 식단표 안내', '12월 구내식당 식단표입니다. 금일 점심: 김치찌개, 동치미, 계란말이. 비빔냉면도 추천합니다.', 'false', '2025-12-01T09:00:00', 'true', '', ''],
  ['noti-003', '[보안] 페르소나 키 관리 수칙', '페르소나 키(실명)는 절대 외부에 노출되어서는 안 됩니다. 작전 중에는 반드시 코드명을 사용하시기 바랍니다.', 'true', '2025-12-15T11:00:00', 'true', '', ''],

  // 최요원 대상
  ['noti-004', '[현무1팀] 단독 출동 금지 안내', '최 요원의 잦은 단독 출동 사고로 인해, 향후 모든 출동은 2인 이상 팀 동반을 의무화합니다.', 'true', '2025-12-29T10:00:00', 'false', '출동구조반', 'agent-002'],
  ['noti-005', '오염도 관리 안내', '일주일에 한 번 정기 검진을 받고 계신 요원들께 감사드립니다. 지속적인 자가 관리 부탁드립니다.', 'false', '2025-12-20T09:00:00', 'true', '', 'agent-002'],

  // 류재관 대상
  ['noti-006', '부적 제작 자재 입고 안내', '황지 신규 입고가 완료되었습니다. 장비관리반에서 수령 가능합니다.', 'false', '2025-12-20T14:00:00', 'true', '', 'agent-003'],

  // 김솔음 대상
  ['noti-007', '신입 요원 교육 일정 안내', '2026년 1월 8일 신입 요원 교육에 선배 요원으로 참석해주시기 바랍니다.', 'false', '2025-12-27T10:00:00', 'false', '', 'agent-004'],

  // 해금 대상
  ['noti-008', '[팀장] 월례 회의 안내', '현무3팀 팀장님, 1월 5일 14시 월례 회의에 참석 부탁드립니다.', 'false', '2025-12-30T10:00:00', 'false', '', 'agent-005'],

  // 고영은 대상
  ['noti-009', '[백호2팀] 의료 관련 재난 우선 배정', '의료 지식을 보유한 박하 요원께 의료 관련 재난을 우선 배정하겠습니다.', 'false', '2025-12-25T10:00:00', 'true', '신규조사반', 'agent-006'],

  // 장허운 대상
  ['noti-010', '[주작2팀] 현장정리 심리 지원 프로그램', '현장정리 업무 특성상 심리적 부담이 큰 점을 고려하여, 월 1회 상담 프로그램을 운영합니다. 신청 바랍니다.', 'false', '2025-12-22T14:00:00', 'false', '현장정리반', 'agent-007'],

  // 부서별
  ['noti-011', '[현무팀] 도깨비 초롱 재충전 안내', '도깨비 초롱 사용 후 3일 이내 반납하여 재충전해주시기 바랍니다.', 'false', '2025-12-22T09:00:00', 'true', '출동구조반', ''],
];
const wsNotifications = XLSX.utils.aoa_to_sheet(notificationsData);
XLSX.utils.book_append_sheet(wb, wsNotifications, 'notifications');

// ===== 7. EQUIPMENT SHEET =====
const equipmentData = [
  ['id', 'name', 'category', 'description', 'totalStock', 'availableStock', 'requiresApproval', 'specialNote'],
  ['eq-001', '도깨비불', '일반대여', '어둠 속 길 안내용 조명 장비', 10, 8, 'true', ''],
  ['eq-002', '악의 저울', '일반대여', '오염도 측정 장비', 5, 3, 'true', ''],
  ['eq-003', '간이 유리감옥', '일반대여', '소형 개체 봉인용 감금 장치', 8, 6, 'true', ''],
  ['eq-004', '해태상(소형)', '일반대여', '결계 설치용 해태 조각상', 12, 10, 'true', ''],
  ['eq-005', '줄잡이', '일반대여', '괴담 존재 포획 및 제어용 특수 밧줄', 15, 12, 'true', ''],
  ['eq-006', '신발끈', '일반대여', '빠른 이동 및 긴급 탈출용 신발', 20, 18, 'true', ''],
  ['eq-007', '은심장', '고위급대여', '착용자를 선한 사람으로 인정받게 하여 집단 영향력 행사', 3, 2, 'true', '탐라행 급행열차 사건 이후 대여만 가능. 팀장급 이상 승인 필요'],
  ['eq-008', '도깨비 초롱', '고위급대여', '특수 조명 및 탐사용 초롱', 5, 3, 'true', '3일 후 재충전 필요'],
  ['eq-009', '도깨비 감투', '고위급대여', '착용 시 투명화 능력 부여', 2, 1, 'true', '특별 승인 필요. 부장급 이상 결재'],
  ['eq-010', '유리 손포', '지급', '오염 물질 취급용 특수 장갑', 500, 450, 'false', '소모품. 현장정리반 필수'],
  ['eq-011', '포승줄', '지급', '봉인 문양이 새겨진 특수 포승줄', 200, 180, 'false', '소모품'],
  ['eq-012', '시큼달큼', '지급', '정신 오염 해독 및 안정화용 사탕', 1000, 950, 'false', '소모품. 복용 후 30분 효과 지속'],
  ['eq-013', '메모리얼 그립톡', '지급', '기억 고정 및 정신 보호용 휴대폰 액세서리', 150, 120, 'false', '도깨비공방 제작. 분실 시 즉시 보고'],
];
const wsEquipment = XLSX.utils.aoa_to_sheet(equipmentData);
XLSX.utils.book_append_sheet(wb, wsEquipment, 'equipment');

// ===== 8. LOCATIONS SHEET =====
const locationsData = [
  ['id', 'name', 'description', 'operatingHours', 'requiresApproval', 'specialNote'],
  ['loc-001', '도깨비 공방', '특수 장비 제작 및 수리. 초재관 주요 장비 제작처로 비밀 협력 관계 유지', '09:00-18:00', 'false', '초재관과 비밀 협력 관계. 메모리얼 그립톡 등 대부분 장비 제작'],
  ['loc-002', '바리데기 세공소', '봉인 장치 및 부적 제작. 전통 방식의 영적 도구 제작 전문', '10:00-17:00', 'false', '전통 부적 및 봉인 도구 전문'],
  ['loc-003', '이정 책방', '고문서 열람 및 괴담 관련 역사 연구 시설', '08:00-20:00', 'false', '고서적 및 과거 재난 기록 보관'],
  ['loc-004', '용천 선녀탕', '정신 오염 정화 전문 시설. 방문 시 오염도 -30% 효과', '06:00-22:00', 'true', '오염도 -30% 효과. 승인 필요. 월 2회 제한'],
];
const wsLocations = XLSX.utils.aoa_to_sheet(locationsData);
XLSX.utils.book_append_sheet(wb, wsLocations, 'locations');

// Create data directory
const dataDir = join(__dirname, '..', 'data');
try {
  mkdirSync(dataDir, { recursive: true });
} catch (err) {
  // Directory already exists
}

// Write to file
const outputPath = join(dataDir, 'haetae_personalized_data_v2.xlsx');
XLSX.writeFile(wb, outputPath);

console.log(`✅ 최종 맞춤형 데이터 엑셀 파일이 생성되었습니다: ${outputPath}`);
console.log('\n📊 포함된 6명의 맞춤형 캐릭터:');
console.log('1. 박홍림 (HMU-001, 홍화) - 현무1팀 팀장');
console.log('2. 최요원 (HMU-002, 미상) - 현무1팀, 사고 다발');
console.log('3. 류재관 (HMU-003, 청동) - 현무1팀, 부적 전문');
console.log('4. 김솔음 (HMU-004, 포도) - 현무1팀, 주인공');
console.log('5. 해금 (HMU-301, 해금) - 현무3팀 팀장');
console.log('6. 고영은 (BKH-201, 박하) - 백호2팀, 의료 지식');
console.log('7. 장허운 (JJK-201, 화각) - 주작2팀, 현장정리');
console.log('\n✅ 코드 형식: HMU-001, BKH-201, JJK-201');
console.log('✅ 코드명 vs 코드 구분 완료');
console.log('✅ 장허운, 고영은 백일몽 정보 제외');
